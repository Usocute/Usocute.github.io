{
    "version": "https://jsonfeed.org/version/1",
    "title": "脆弱星球 • All posts by \"index\" tag",
    "description": "立于皓月之边,不弱星光之势",
    "home_page_url": "https://eliauk.cc",
    "items": [
        {
            "id": "https://eliauk.cc/post/f5a946ac.html",
            "url": "https://eliauk.cc/post/f5a946ac.html",
            "title": "MySQL 视图与索引",
            "date_published": "2020-09-24T07:50:11.000Z",
            "content_html": "<h2>视图</h2> \n### 基本概念\n视图本身是一张虚拟表，不存放任何数据。在使用SQL语句访问视图的时候，获取的数据是MySQL从其它表中生成的，视图和表在同一个命名空间。视图查询数据相对安全，视图可以隐藏一些数据和结构，只让用户看见权限内的数据，使复杂的查询易于理解和使用。\n<h3 id=\"视图用法\"><a class=\"markdownIt-Anchor\" href=\"#视图用法\">#</a> 视图用法</h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-comment\">#### 基本语法</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">OR</span> <span class=\"hljs-keyword\">REPLACE</span> <span class=\"hljs-keyword\">VIEW</span> view_name <br><span class=\"hljs-keyword\">AS</span> select_statement<br></code></pre></td></tr></table></figure>\n<p><strong>注意事项：表和视图共享数据库中相同的名称空间，因此，数据库不能包含具有相同名称的表和视图。</strong></p>\n<h4 id=\"视图调用\"><a class=\"markdownIt-Anchor\" href=\"#视图调用\">#</a> 视图调用</h4>\n<p><strong>和 MySQL 的表查询基本一致，可以使用各种查询条件。</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">SELECT</span> * <span class=\"hljs-keyword\">FROM</span> user_order_view <span class=\"hljs-keyword\">WHERE</span> user_name=<span class=\"hljs-string\">&#x27;Cicada&#x27;</span>;<br></code></pre></td></tr></table></figure>\n<h4 id=\"查看视图\"><a class=\"markdownIt-Anchor\" href=\"#查看视图\">#</a> 查看视图</h4>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">SHOW</span> <span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">VIEW</span> user_order_view ;<br></code></pre></td></tr></table></figure>\n<h4 id=\"修改视图\"><a class=\"markdownIt-Anchor\" href=\"#修改视图\">#</a> 修改视图</h4>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">VIEW</span> view_name <span class=\"hljs-keyword\">AS</span> select_statement ;<br></code></pre></td></tr></table></figure>\n<h4 id=\"删除视图\"><a class=\"markdownIt-Anchor\" href=\"#删除视图\">#</a> 删除视图</h4>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">VIEW</span> [<span class=\"hljs-keyword\">IF</span> <span class=\"hljs-keyword\">EXISTS</span>] view_name ;<br></code></pre></td></tr></table></figure>\n<h3 id=\"视图更新\"><a class=\"markdownIt-Anchor\" href=\"#视图更新\">#</a> 视图更新</h3>\n<p>** 在指定条件允许的情况下，可以通过在视图上操作更新，删除，甚至写入数据，进而更新视图所涉及的相关表。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">UPDATE</span> user_order_view <span class=\"hljs-keyword\">SET</span> user_name=<span class=\"hljs-string\">&#x27;smile&#x27;</span> <span class=\"hljs-keyword\">WHERE</span> <span class=\"hljs-keyword\">id</span>=<span class=\"hljs-string\">&#x27;1&#x27;</span>;<br></code></pre></td></tr></table></figure>\n<ul class=\"task-list\">\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_0\" checked=\"true\" disabled=\"true\"><label for=\"cbx_0\"> 如果视图定义时使用聚合函数，分组等特殊操作，则无法更新。</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_1\" checked=\"true\" disabled=\"true\"><label for=\"cbx_1\"> MySQL 不支持在视图上创建触发器。</label></p>\n</li>\n</ul>\n<h3 id=\"注意事项\"><a class=\"markdownIt-Anchor\" href=\"#注意事项\">#</a> 注意事项</h3>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_2\" checked=\"true\" disabled=\"true\"><label for=\"cbx_2\"> MySQL 并不支持在视图中创建索引，使用视图的时候可能会引发很多查询性能问题</label></li>\n</ul>\n<h2 id=\"索引\"><a class=\"markdownIt-Anchor\" href=\"#索引\">#</a> 索引</h2>\n<h3 id=\"索引的优缺点\"><a class=\"markdownIt-Anchor\" href=\"#索引的优缺点\">#</a> 索引的优缺点</h3>\n<h4 id=\"优点\"><a class=\"markdownIt-Anchor\" href=\"#优点\">#</a> 优点</h4>\n<ul>\n<li>索引大大减小了服务器需要扫描的数据量</li>\n<li>索引可以帮助服务器避免排序和临时表</li>\n<li>索引对于 InnoDB（对索引支持行级锁）非常重要，因为它可以让查询锁更少的元组。</li>\n</ul>\n<h4 id=\"缺点\"><a class=\"markdownIt-Anchor\" href=\"#缺点\">#</a> 缺点</h4>\n<ul>\n<li>虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行 INSERT、UPDATE 和 DELETE。因为更新表时，MySQL 不仅要保存数据，还要保存索引文件。</li>\n<li>建立索引会占用磁盘空间的索引文件。</li>\n<li>如果某个数据列包含许多重复的内容，为它建立索引就没有太大的实际效果。</li>\n<li>对于非常小的表，大部分情况下简单的全表扫描更高效；</li>\n</ul>\n<h3 id=\"索引创建语法\"><a class=\"markdownIt-Anchor\" href=\"#索引创建语法\">#</a> 索引创建语法</h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-comment\">-- 普通索引</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">index</span> index1 <span class=\"hljs-keyword\">on</span> student (<span class=\"hljs-keyword\">id</span>);<br><br><span class=\"hljs-comment\">-- 唯一索引</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">UNIQUE</span> <span class=\"hljs-keyword\">INDEX</span> index2 <span class=\"hljs-keyword\">on</span> student(<span class=\"hljs-keyword\">id</span>);<br><br><span class=\"hljs-comment\">-- 全文索引</span><br><span class=\"hljs-keyword\">CREATE</span> FULLTEXT <span class=\"hljs-keyword\">INDEX</span> index3 <span class=\"hljs-keyword\">on</span> student(adress(<span class=\"hljs-number\">20</span>));<br><br><span class=\"hljs-comment\">-- 创建单列索引</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">INDEX</span> INDEX5 <span class=\"hljs-keyword\">on</span> student(<span class=\"hljs-keyword\">name</span>(<span class=\"hljs-number\">10</span>));<br><br><span class=\"hljs-comment\">-- 联合索引</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">INDEX</span> INDEX6 <span class=\"hljs-keyword\">ON</span> student (<span class=\"hljs-keyword\">name</span>,<span class=\"hljs-keyword\">id</span>); <br><br><br><span class=\"hljs-comment\">-- 普通索引</span><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> student <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">INDEX</span> index1(<span class=\"hljs-keyword\">id</span>);<br><br><span class=\"hljs-comment\">-- 唯一索引</span><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> student <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">UNIQUE</span> <span class=\"hljs-keyword\">INDEX</span> index2(<span class=\"hljs-keyword\">id</span>);<br><br><span class=\"hljs-comment\">-- 全文索引</span><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> student <span class=\"hljs-keyword\">add</span> FULLTEXT <span class=\"hljs-keyword\">INDEX</span> index3 (<span class=\"hljs-keyword\">NAME</span>(<span class=\"hljs-number\">20</span>));<br><br><span class=\"hljs-comment\">-- 单列索引</span><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> student <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">INDEX</span> index4 (adress(<span class=\"hljs-number\">20</span>));<br><br><span class=\"hljs-comment\">-- 联合索引</span><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> student <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">INDEX</span> INDEX5 (<span class=\"hljs-keyword\">name</span>,<span class=\"hljs-keyword\">id</span>);<br></code></pre></td></tr></table></figure>",
            "tags": [
                "MySQL",
                "数据库",
                "View",
                "index"
            ]
        }
    ]
}